(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[457],{283:(e,r,t)=>{"use strict";t.d(r,{A:()=>n}),t(5155);var a=t(2115);t(9323),t(6104);let s=(0,a.createContext)({user:null,userRole:null,loading:!0,isAdmin:!1,error:null}),n=()=>{let e=(0,a.useContext)(s);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},2047:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var a=t(5155),s=t(2115),n=t(5317),i=t(7505),o=t(6104),l=t(283);function d(){let{user:e}=(0,l.A)(),[r,t]=(0,s.useState)([]),[d,c]=(0,s.useState)(null),[m,u]=(0,s.useState)([]),[h,x]=(0,s.useState)(""),[p,g]=(0,s.useState)(!0),[b,f]=(0,s.useState)(!1),[w,v]=(0,s.useState)(null),j=(0,s.useRef)(null),k=(0,s.useRef)(null),y=(0,s.useRef)(null),N=()=>{var e;null==(e=j.current)||e.scrollIntoView({behavior:"smooth"})};(0,s.useEffect)(()=>(y.current=setTimeout(()=>{p&&(console.warn("Loading timeout reached, stopping loader"),g(!1),v("Loading took too long. Please refresh the page."))},1e4),()=>{y.current&&clearTimeout(y.current)}),[p]),(0,s.useEffect)(()=>{if(!e||!o.db){g(!1),e?o.db||v("Database service is not available."):v("Please sign in to access the chat.");return}},[e]),(0,s.useEffect)(()=>{if(!e||!o.db)return void g(!1);let r=null;return(async()=>{try{let e=(0,n.P)((0,n.rJ)(o.db,"chatRooms"),(0,n.My)("lastMessageAt","desc"));r=(0,n.aQ)(e,e=>{try{let r=[];e.forEach(e=>{r.push({id:e.id,...e.data()})}),t(r),g(!1),v(null),y.current&&(clearTimeout(y.current),y.current=null)}catch(e){console.error("Error processing chat rooms snapshot:",e),g(!1),v("Failed to process chat rooms data.")}},e=>{console.error("Error loading chat rooms:",e),g(!1),v("Failed to load chat rooms. Please check your connection.")})}catch(e){console.error("Error setting up chat rooms listener:",e),g(!1),v("Failed to initialize chat rooms.")}})(),()=>{r&&r()}},[e]),(0,s.useEffect)(()=>{if(!d||!o.db)return void u([]);let e=null;return(async()=>{try{let r=(0,n.P)((0,n.rJ)(o.db,"messages"),(0,n._M)("chatRoomId","==",d.id),(0,n.My)("timestamp","asc"));e=(0,n.aQ)(r,e=>{try{let r=[];e.forEach(e=>{r.push({id:e.id,...e.data()})}),u(r),N()}catch(e){console.error("Error processing messages snapshot:",e)}},e=>{console.error("Error loading messages:",e)})}catch(e){console.error("Error setting up messages listener:",e)}})(),()=>{e&&e()}},[d]),(0,s.useEffect)(()=>{N()},[m]);let C=async()=>{if(h.trim()&&d&&e&&!b&&o.db){f(!0);try{let r={senderId:e.uid,senderName:"Admin",senderType:"admin",content:h.trim(),type:"text",timestamp:(0,n.O5)(),isRead:!1,chatRoomId:d.id};await (0,n.gS)((0,n.rJ)(o.db,"messages"),r),await (0,n.mZ)((0,n.H9)(o.db,"chatRooms",d.id),{lastMessage:h.trim(),lastMessageAt:(0,n.O5)()}),x("")}catch(e){console.error("Error sending message:",e),alert("Failed to send message. Please try again.")}finally{f(!1)}}},E=async r=>{var t;let a=null==(t=r.target.files)?void 0:t[0];if(a&&d&&e&&!b&&o.db&&o.IG){if(!["image/jpeg","image/jpg","image/png","image/svg+xml"].includes(a.type))return void alert("Please select a valid image file (JPG, PNG, or SVG)");if(a.size>5242880)return void alert("File size must be less than 5MB");f(!0);try{let r="chat_images/admin_".concat(Date.now(),"_").concat(a.name),t=(0,i.KR)(o.IG,r),s=await (0,i.D)(t,a),l=await (0,i.qk)(s.ref),c={senderId:e.uid,senderName:"Admin",senderType:"admin",content:"Image",type:"image",imageUrl:l,imageName:a.name,timestamp:(0,n.O5)(),isRead:!1,chatRoomId:d.id};await (0,n.gS)((0,n.rJ)(o.db,"messages"),c),await (0,n.mZ)((0,n.H9)(o.db,"chatRooms",d.id),{lastMessage:"Image",lastMessageAt:(0,n.O5)()}),k.current&&(k.current.value="")}catch(e){console.error("Error uploading image:",e),alert("Failed to upload image. Please try again.")}finally{f(!1)}}};return e?w?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-red-50 via-pink-50 to-rose-100",children:(0,a.jsxs)("div",{className:"text-center p-12 bg-white/90 backdrop-blur-md rounded-3xl shadow-2xl border border-white/50 transform hover:scale-105 transition-all duration-500",children:[(0,a.jsx)("div",{className:"w-24 h-24 bg-gradient-to-br from-red-400 to-pink-600 rounded-full flex items-center justify-center mx-auto mb-8 shadow-2xl",children:(0,a.jsx)("svg",{className:"w-12 h-12 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,a.jsx)("h2",{className:"text-3xl font-bold bg-gradient-to-r from-red-600 to-pink-600 bg-clip-text text-transparent mb-4",children:"Connection Error"}),(0,a.jsx)("p",{className:"text-gray-600 font-medium text-lg mb-6",children:w}),(0,a.jsx)("button",{onClick:()=>{v(null),g(!0),window.location.reload()},className:"px-8 py-4 bg-gradient-to-r from-red-500 to-pink-600 text-white rounded-2xl hover:from-red-600 hover:to-pink-700 transition-all duration-300 font-bold shadow-lg hover:shadow-xl transform hover:scale-105",children:"Try Again"})]})}):p?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:(0,a.jsxs)("div",{className:"text-center p-12 bg-white/90 backdrop-blur-md rounded-3xl shadow-2xl border border-white/50 transform hover:scale-105 transition-all duration-500",children:[(0,a.jsxs)("div",{className:"relative mb-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-20 w-20 border-4 border-blue-200 border-t-blue-600 mx-auto"}),(0,a.jsx)("div",{className:"absolute inset-0 rounded-full h-20 w-20 border-4 border-purple-200 border-b-purple-600 mx-auto animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}})]}),(0,a.jsx)("h2",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 bg-clip-text text-transparent mb-4",children:"Loading Chat"}),(0,a.jsx)("p",{className:"text-gray-600 font-medium text-lg mb-4",children:"Setting up your conversation space..."}),(0,a.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce"}),(0,a.jsx)("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,a.jsx)("div",{className:"w-2 h-2 bg-indigo-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})}):(0,a.jsxs)("div",{className:"h-screen flex flex-col md:flex-row bg-gradient-to-br from-pink-50 via-pink-50 to-pink-100",children:[(0,a.jsxs)("div",{className:"w-full md:w-80 lg:w-96 bg-pink-50/90 backdrop-blur-sm border-r border-pink-200/30 flex flex-col shadow-[0_8px_30px_rgb(233,30,99,0.15)]",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-gradient-to-r from-pink-100 to-pink-100 bg-gradient-to-r from-pink-50/50 to-pink-50/50",children:[(0,a.jsx)("h2",{className:"text-sm font-bold bg-gradient-to-r from-pink-600 to-pink-600 bg-clip-text text-transparent",children:"User Chats"}),(0,a.jsxs)("p",{className:"text-sm text-pink-600 mt-1 font-medium",children:[r.length," conversations"]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-3 sm:p-4",children:0===r.length?(0,a.jsxs)("div",{className:"p-6 sm:p-8 text-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-gradient-to-br from-gray-300 to-gray-500 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:(0,a.jsx)("svg",{className:"w-6 h-6 sm:w-8 sm:h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a2 2 0 01-2-2v-2M5 8h2m0 0V6a2 2 0 012-2h6a2 2 0 012 2v2m-6 0h4"})})}),(0,a.jsx)("h3",{className:"text-base sm:text-lg font-bold text-gray-700 mb-3",children:"No Conversations"}),(0,a.jsx)("p",{className:"text-sm sm:text-base text-gray-500 font-medium",children:"Chat rooms will appear here when users start conversations"})]}):r.map(e=>(0,a.jsx)("div",{onClick:()=>c(e),className:"m-2 p-4 rounded-lg cursor-pointer transition-all duration-300 transform hover:scale-[1.01] hover:shadow-lg ".concat((null==d?void 0:d.id)===e.id?"bg-gradient-to-r from-pink-500 to-pink-500 text-white shadow-xl":"bg-pink-50/70 hover:bg-pink-100/90 shadow-md border border-pink-200/50"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold ".concat((null==d?void 0:d.id)===e.id?"bg-white/20 text-white":"bg-gradient-to-br from-pink-400 to-pink-500 text-white"),children:e.userName.charAt(0).toUpperCase()}),(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsx)("h3",{className:"font-bold text-base truncate ".concat((null==d?void 0:d.id)===e.id?"text-white":"text-pink-800"),children:e.userName}),(0,a.jsx)("p",{className:"text-sm truncate ".concat((null==d?void 0:d.id)===e.id?"text-white/80":"text-pink-600"),children:e.userEmail}),(0,a.jsx)("p",{className:"text-sm truncate mt-1 ".concat((null==d?void 0:d.id)===e.id?"text-white/70":"text-pink-500"),children:e.lastMessage}),e.unreadCount>0&&(0,a.jsx)("span",{className:"inline-block px-2 py-1 rounded-full text-xs font-bold mt-2 ".concat((null==d?void 0:d.id)===e.id?"bg-white/20 text-white":"bg-pink-600 text-white"),children:e.unreadCount})]})]})},e.id))})]}),(0,a.jsx)("div",{className:"".concat(d?"block":"hidden sm:block"," flex-1 flex flex-col bg-pink-50/30 backdrop-blur-sm"),children:d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"bg-pink-50/80 backdrop-blur-md border-b border-pink-200/30 p-4 shadow-lg",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("button",{onClick:()=>c(null),className:"sm:hidden p-2 rounded-lg hover:bg-pink-100 transition-colors",children:(0,a.jsx)("svg",{className:"w-6 h-6 text-pink-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-pink-400 to-pink-500 rounded-full flex items-center justify-center text-white font-bold text-lg shadow-lg",children:d.userName.charAt(0).toUpperCase()}),(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsx)("h3",{className:"font-bold text-lg text-pink-800 truncate",children:d.userName}),(0,a.jsx)("p",{className:"text-sm text-pink-600 font-medium truncate",children:d.userEmail}),(0,a.jsxs)("div",{className:"flex items-center mt-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-pink-400 rounded-full mr-2 animate-pulse"}),(0,a.jsx)("span",{className:"text-sm text-pink-600 font-medium",children:"Online"})]})]})]})}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gradient-to-b from-transparent to-pink-50/30",children:[0===m.length?(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsxs)("div",{className:"text-center p-8",children:[(0,a.jsx)("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-r from-pink-200 to-pink-300 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,a.jsx)("svg",{className:"w-8 h-8 sm:w-10 sm:h-10 text-pink-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-3.582 8-8 8a8.955 8.955 0 01-3.774-.9L3 21l1.9-6.226A8.955 8.955 0 013 12a8 8 0 018-8 8 8 0 018 8z"})})}),(0,a.jsx)("h3",{className:"text-lg sm:text-xl font-semibold text-pink-700 mb-4",children:"Start a conversation"}),(0,a.jsx)("p",{className:"text-sm sm:text-base text-pink-500 max-w-md mx-auto leading-relaxed",children:"Choose a chat room from the sidebar to start messaging"})]})}):m.map(e=>{let r="admin"===e.senderType;return(0,a.jsx)("div",{className:"flex ".concat(r?"justify-end":"justify-start"),children:(0,a.jsxs)("div",{className:"max-w-[75%] p-4 rounded-xl shadow-md transition-all duration-300 hover:shadow-lg ".concat(r?"bg-gradient-to-r from-pink-400 to-pink-500 text-white transform hover:scale-[1.02]":"bg-pink-50/90 backdrop-blur-sm text-pink-800 border border-pink-200/50 transform hover:scale-[1.02]"),children:["text"===e.type?(0,a.jsx)("p",{className:"text-sm leading-relaxed font-medium break-words",children:e.content}):(0,a.jsxs)("div",{className:"space-y-2",children:[e.imageUrl&&(0,a.jsx)("div",{className:"relative w-48 h-36",children:(0,a.jsx)("img",{src:e.imageUrl,alt:e.imageName||"Shared image",className:"w-full h-full object-cover rounded-lg shadow-sm cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>window.open(e.imageUrl,"_blank")})}),(0,a.jsx)("p",{className:"text-xs opacity-75 font-medium",children:e.imageName})]}),(0,a.jsx)("p",{className:"text-xs mt-2 font-medium ".concat(r?"text-white/70":"text-pink-500"),children:(e=>{if(!e)return"";let r=e instanceof n.Dc?e.toDate():e,t=new Date().getTime()-r.getTime(),a=Math.floor(t/6e4),s=Math.floor(t/36e5);return Math.floor(t/864e5)>0?"".concat(r.getDate(),"/").concat(r.getMonth()+1,"/").concat(r.getFullYear()):s>0?"".concat(s,"h ago"):a>0?"".concat(a,"m ago"):"Just now"})(e.timestamp)})]})},e.id)}),(0,a.jsx)("div",{ref:j})]}),(0,a.jsx)("div",{className:"bg-pink-50/80 backdrop-blur-md border-t border-pink-200/30 p-4 shadow-2xl",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("input",{type:"file",ref:k,onChange:E,accept:"image/jpeg,image/jpg,image/png,image/svg+xml",className:"hidden"}),(0,a.jsx)("button",{onClick:()=>{var e;return null==(e=k.current)?void 0:e.click()},disabled:b,className:"p-3 text-pink-500 hover:text-pink-600 transition-all duration-300 bg-pink-50/90 backdrop-blur-sm rounded-xl shadow-md hover:shadow-lg transform hover:scale-110 border border-pink-200 disabled:opacity-50",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),(0,a.jsx)("input",{type:"text",value:h,onChange:e=>x(e.target.value),onKeyPress:e=>"Enter"===e.key&&C(),placeholder:"Type a message...",disabled:b,className:"flex-1 border border-pink-200 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-400 focus:border-pink-400 transition-all duration-300 bg-pink-50/90 backdrop-blur-sm shadow-md text-pink-800 placeholder-pink-500 font-medium disabled:opacity-50 text-sm"}),(0,a.jsx)("button",{onClick:C,disabled:b||!h.trim(),className:"bg-gradient-to-r from-pink-400 to-pink-500 text-white px-6 py-3 rounded-xl hover:from-pink-500 hover:to-pink-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 shadow-md hover:shadow-lg transform hover:scale-105 font-bold text-sm",children:b?(0,a.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):"Send"})]})})]}):(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center bg-gradient-to-br from-pink-50/50 to-pink-50/50 p-1",children:(0,a.jsxs)("div",{className:"text-center p-2 max-w-xs mx-auto",children:[(0,a.jsx)("div",{className:"w-6 h-6 bg-gradient-to-br from-pink-400 to-pink-600 rounded-full flex items-center justify-center mx-auto mb-2 shadow-xl",children:(0,a.jsx)("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-3.582 8-8 8a8.955 8.955 0 01-3.774-.9L3 21l1.9-6.226A8.955 8.955 0 013 12a8 8 0 018-8 8 8 0 018 8z"})})}),(0,a.jsx)("h3",{className:"text-[8px] font-bold bg-gradient-to-r from-pink-600 to-pink-600 bg-clip-text text-transparent mb-1",children:"Select a conversation"}),(0,a.jsx)("p",{className:"text-pink-600 font-medium text-[6px] mb-2",children:"Choose a chat from the sidebar to start messaging"}),(0,a.jsx)("div",{className:"p-1 bg-white/60 backdrop-blur-sm rounded-lg border border-white/50 shadow-md",children:(0,a.jsx)("p",{className:"text-[6px] text-pink-500",children:"\uD83D\uDCAC Professional chat interface for seamless communication"})})]})})})]}):(0,a.jsx)("div",{className:"flex items-center justify-center h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:(0,a.jsxs)("div",{className:"text-center p-8 bg-white/80 backdrop-blur-sm rounded-2xl shadow-2xl border border-white/20 max-w-md mx-4",children:[(0,a.jsx)("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg",children:(0,a.jsx)("svg",{className:"w-10 h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,a.jsx)("h2",{className:"text-3xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent mb-4",children:"Access Required"}),(0,a.jsx)("p",{className:"text-gray-600 leading-relaxed",children:"Please sign in to access the chat system and connect with our team."})]})})}function c(){return(0,o.Gg)()?o.db&&o.IG?(0,a.jsx)(d,{}):(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"text-center p-8 bg-white rounded-lg shadow-md max-w-md",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Database Service Unavailable"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Firebase database or storage is not available. Please check your configuration."})]})}):(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"text-center p-8 bg-white rounded-lg shadow-md max-w-md",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Chat Service Unavailable"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Firebase is not configured. Please set up your Firebase environment variables to use the chat feature."}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Contact your administrator for assistance with Firebase configuration."})]})})}},4288:(e,r,t)=>{Promise.resolve().then(t.bind(t,2047))},6104:(e,r,t)=>{"use strict";t.d(r,{Gg:()=>h,IG:()=>m,db:()=>c,j2:()=>u});var a=t(3915),s=t(1906),n=t(5317),i=t(7505),o=t(4903);let l={apiKey:"AIzaSyBYQA66rKOPrb4kce-hYCTYAbGKanVGbZ8",authDomain:"mirrorsbeautylounge-7c5ff.firebaseapp.com",projectId:"mirrorsbeautylounge-7c5ff",storageBucket:"mirrorsbeautylounge-7c5ff.firebasestorage.app",messagingSenderId:"1029530532506",appId:"1:1029530532506:web:2fa18cc521b2524e5afd23",measurementId:"G-GMWQSDP9JW"},d=null,c=null,m=null,u=null;function h(){return null!==d}!0;try{d=(0,a.initializeApp)(l),c=(0,n.aU)(d),m=(0,i.c7)(d),u=(0,o.getAuth)(d);try{(0,s.P5)(d)}catch(e){console.warn("Firebase Analytics initialization failed:",e)}}catch(e){console.error("Firebase initialization failed:",e),u=null}},9323:(e,r,t)=>{"use strict";t.d(r,{eg:()=>i,ej:()=>o,nW:()=>d,yN:()=>c});var a=t(4903),s=t(5317),n=t(6104);let i=async e=>{try{if(!n.j2)return{error:"Firebase auth is not initialized"};if(n.j2.currentUser){if(await (0,a.updateProfile)(n.j2.currentUser,{displayName:e}),!n.db)throw Error("Firestore is not initialized");let r=(0,s.H9)(n.db,"users",n.j2.currentUser.uid);await (0,s.mZ)(r,{displayName:e,updatedAt:new Date})}return{error:null}}catch(e){return console.error("Error updating profile:",e),{error:e instanceof Error?e.message:"Unknown error"}}},o=async e=>{try{if(!n.j2)return{error:"Firebase auth is not initialized"};return n.j2.currentUser&&await (0,a.f3)(n.j2.currentUser,e),{error:null}}catch(e){return console.error("Error updating password:",e),{error:e instanceof Error?e.message:"Unknown error"}}},l=async(e,r,t,a)=>{try{let i={uid:e,email:r,displayName:a,role:t,createdAt:new Date,updatedAt:new Date};if(!n.db)throw Error("Firestore is not initialized");return await (0,s.BN)((0,s.H9)(n.db,"users",e),i),{error:null}}catch(e){return{error:e instanceof Error?e.message:"Unknown error"}}},d=async()=>{try{if(!n.j2)return{success:!1,error:"Firebase auth is not initialized"};console.log("Creating admin user: admin@mirrorbeauty.com");let e=await (0,a.createUserWithEmailAndPassword)(n.j2,"admin@mirrorbeauty.com","admin123");return await (0,a.updateProfile)(e.user,{displayName:"Admin User"}),await l(e.user.uid,"admin@mirrorbeauty.com","admin","Admin User"),console.log("Admin user created successfully"),{success:!0,error:null}}catch(e){return console.error("Error creating admin user:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}},c=async(e,r,a,s)=>{try{if(console.log("Creating new user:",e),!(null===n.j2||void 0===n.j2?void 0:n.j2.currentUser))return{success:!1,error:"No authenticated user found"};let{initializeApp:i}=await Promise.resolve().then(t.bind(t,3915)),{getAuth:o,createUserWithEmailAndPassword:d,updateProfile:c,signOut:m}=await Promise.resolve().then(t.bind(t,4903)),u=i({apiKey:"AIzaSyBYQA66rKOPrb4kce-hYCTYAbGKanVGbZ8",authDomain:"mirrorsbeautylounge-7c5ff.firebaseapp.com",projectId:"mirrorsbeautylounge-7c5ff",storageBucket:"mirrorsbeautylounge-7c5ff.firebasestorage.app",messagingSenderId:"1029530532506",appId:"1:1029530532506:web:2fa18cc521b2524e5afd23",measurementId:"G-GMWQSDP9JW"},"secondary"),h=o(u),x=await d(h,e,r);a&&await c(x.user,{displayName:a}),await l(x.user.uid,e,s,a),await m(h);try{"delete"in u&&"function"==typeof u.delete&&await u.delete()}catch(e){console.log("Secondary app cleanup not needed or failed:",e)}return console.log("New user created successfully without affecting current session"),{success:!0,error:null,user:x.user}}catch(e){return console.error("Error creating new user:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}}},e=>{e.O(0,[135,210,748,441,964,358],()=>e(e.s=4288)),_N_E=e.O()}]);